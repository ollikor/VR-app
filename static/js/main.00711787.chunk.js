(this["webpackJsonpvr-app"]=this["webpackJsonpvr-app"]||[]).push([[0],{32:function(e,t,a){e.exports=a(60)},38:function(e,t,a){},39:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(11),l=a.n(i),s=(a(38),a(12)),o=a(13),c=a(19),u=a(17),m=(a(39),"Schedule of train stations"),d="Search with station name",h="No trains found",f="No internet connection",p=function(){return r.a.createElement("p",{className:"Header"},m)},v=a(9),T=a.n(v),E=a(21);function w(e){if(!e.ok)throw Error(e.statusText);return e}function b(e){if(!1===window.navigator.onLine)throw new Error(f);return fetch(e).then(w).then((function(e){return e.json()}))}function g(e){return b("https://rata.digitraffic.fi/api/v1/live-trains/station/".concat(e,"?minutes_before_departure=30&minutes_after_departure=15&minutes_before_arrival=30&minutes_after_arrival=15"))}var S=function(){return r.a.createElement("div",{className:"Big-loader"})},y=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={searchText:"",stations:[],newStationsCodes:[],error:"",loading:!1},e.handleSearch=function(t){t.preventDefault(),e.setState({error:""});var a=[],n=t.target.value.charAt(0).toUpperCase()+t.target.value.slice(1);e.setState({searchText:n});var r=e.state.newStationsCodes;if(n.length)for(var i=0;i<r.length;i++){r[i].station.includes(n)&&(a.push(r[i]),e.setState({stations:a}))}else e.setState({stations:[]})},e.selectStation=function(){var t=Object(E.a)(T.a.mark((function t(a){var n,r,i;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),""===e.state.searchText){t.next=17;break}if(!(n=e.state.newStationsCodes.find((function(t){return t.station===e.state.searchText})))){t.next=17;break}return e.setState({loading:!0}),t.prev=5,t.next=8,g(n.code);case 8:(r=t.sent).length?e.props.result(r,n.code,e.state.newStationsCodes):(i=h,e.setState({error:i}),e.props.result([])),e.setState({stations:[],loading:!1}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(5),console.log(t.t0),e.setState({error:t.t0.message,stations:[]});case 17:e.setState({loading:!1});case 18:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=Object(E.a)(T.a.mark((function e(){var t,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b("https://rata.digitraffic.fi/api/v1/metadata/stations");case 3:t=e.sent,a=t.map((function(e){return{station:e.stationName,code:e.stationShortCode}})),this.setState({newStationsCodes:a}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({error:e.t0.message});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("form",{onSubmit:function(t){return e.selectStation(t)},className:"Search"},r.a.createElement("div",{className:"SearchContent"},r.a.createElement("label",{className:"SearchTitle"},d),r.a.createElement("input",{onFocus:function(e){return e.target.select()},type:"search",list:"trains",name:"trains",value:this.state.searchText,onChange:function(t){return e.handleSearch(t)}})),r.a.createElement("datalist",{id:"trains"},this.state.stations.map((function(e,t){return r.a.createElement("option",{id:"option",value:e.station,key:t,className:"col col-sm-12 col-md-8 p-2 m-0"})}))),this.state.error?r.a.createElement("p",{className:"Error"},this.state.error):null,this.state.loading?r.a.createElement(S,null):null)}}]),a}(n.Component),N=a(22),C=a(64),k=a(63),R=a(62),O=function(e){var t=function(e,t){var a="#ffffff";return 1!==(1&t)&&(a="#e6e6e6"),!0===e?{color:"#cccccc",backgroundColor:a}:{color:"#262626",backgroundColor:a}};return r.a.createElement("div",{className:"TabContent"},r.a.createElement(R.a,{borderless:!0,responsive:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,e.titleOne),r.a.createElement("th",null,e.titleTwo),r.a.createElement("th",null,e.titleThree),r.a.createElement("th",null,e.titleFour))),r.a.createElement("tbody",null,null!==e.trains&&void 0!==e.trains?e.trains.map((function(e,a){return r.a.createElement("tr",{key:a,style:t(e.cancelled,a)},r.a.createElement("td",null,e.trainType+" "+e.trainNumber),r.a.createElement("td",null,e.departureStation),r.a.createElement("td",null,e.terminal),r.a.createElement("td",null,null!==e.lateTime?r.a.createElement("div",null,r.a.createElement("p",{className:"LatestTime"},e.lateTime),r.a.createElement("p",{className:"ScheduleTime"},"("+e.scheduledTime+")")):e.scheduledTime,e.cancelled?r.a.createElement("p",{className:"Cancelled"},"Cancelled"):null))})):null)))},x=function(e){var t=function(e){for(var t,a=[],n=0;n<e.length;n++){var r=new Date(e[n].scheduledTime);t=Math.floor(new Date(e[n].scheduledTime).getTime()/6e4)-Math.floor(new Date(e[n].actualTime).getTime()/6e4)<0?("0"+new Date(e[n].actualTime).getHours()).slice(-2)+":"+("0"+new Date(e[n].actualTime).getMinutes()).slice(-2):null;var i=("0"+new Date(e[n].scheduledTime).getHours()).slice(-2)+":"+("0"+new Date(e[n].scheduledTime).getMinutes()).slice(-2);e[n].scheduledTime=i;var l={lateTime:t,time:r},s=Object.assign(Object(N.a)({},l),Object(N.a)({},e[n]));a.push(s)}return a},a=function(a){var n,r,i,l,s,o,c,u,m=[],d=[];if(void 0!==e?(r=e.trains,i=e.code,l=e.stations):(r=[],i=null,l=null),r.length){for(var h=0;h<r.length;h++)for(var f=0;f<r[h].timeTableRows.length;f++)if(r[h].timeTableRows[f].stationShortCode===i)if(o=r[h].timeTableRows[0].stationShortCode,u=r[h].timeTableRows[r[h].timeTableRows.length-1].stationShortCode,s=l.find((function(e){return e.code===o})),c=l.find((function(e){return e.code===u})),"ARRIVAL"===r[h].timeTableRows[f].type){var p={trainType:r[h].trainType,trainNumber:r[h].trainNumber,departureStation:s.station,terminal:c.station,cancelled:r[h].cancelled,actualTime:r[h].timeTableRows[f].actualTime,scheduledTime:r[h].timeTableRows[f].scheduledTime};m.push(p)}else{var v={trainType:r[h].trainType,trainNumber:r[h].trainNumber,departureStation:s.station,terminal:c.station,cancelled:r[h].cancelled,actualTime:r[h].timeTableRows[f].actualTime,scheduledTime:r[h].timeTableRows[f].scheduledTime};d.push(v)}return"ARRIVAL"===a?((n=t(m)).sort((function(e,t){return e.time-t.time})),n):((n=t(d)).sort((function(e,t){return e.time-t.time})),n)}};return r.a.createElement("div",null,r.a.createElement(C.a,{id:"controlled-tab"},r.a.createElement(k.a,{eventKey:"arrival",title:"Arrival"},r.a.createElement(O,{titleOne:"Train",titleTwo:"Departure station",titleThree:"Terminal",titleFour:"arrives",trains:a("ARRIVAL")})),r.a.createElement(k.a,{eventKey:"departure",title:"departure"},r.a.createElement(O,{titleOne:"Train",titleTwo:"Departure station",titleThree:"Terminal",titleFour:"Goes",trains:a("DEPARTURE")}))))},j=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={trains:[],code:"",stations:[]},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"col col-sm-12 col-md-6 p-0 App"},r.a.createElement("div",{className:"Container"},r.a.createElement(p,null),r.a.createElement(y,{result:function(t,a,n){return e.setState({trains:t,code:a,stations:n})}}),r.a.createElement(x,{trains:this.state.trains,code:this.state.code,stations:this.state.stations})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(59);l.a.render(r.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[32,1,2]]]);
//# sourceMappingURL=main.00711787.chunk.js.map